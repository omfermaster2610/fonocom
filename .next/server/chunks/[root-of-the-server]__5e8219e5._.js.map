{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 104, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/omars/Documents/OMAR/prototipo/fonocom/db.ts"],"sourcesContent":["import dotenv from 'dotenv';\r\ndotenv.config();\r\n\r\nimport { Pool } from 'pg';\r\n\r\nconsole.log(\"Conectando con DATABASE_URL...\");\r\nconsole.log(\"DATABASE_URL:\", process.env.DATABASE_URL || \"No definida\");\r\n\r\nconst db = new Pool({\r\n  connectionString: process.env.DATABASE_URL,\r\n  ssl: {\r\n    rejectUnauthorized: false,\r\n  },\r\n});\r\n\r\n// Probar conexi칩n al iniciar\r\ndb.connect()\r\n  .then((client) => {\r\n    return client\r\n      .query('SELECT NOW()')\r\n      .then((res) => {\r\n        console.log(\"Conexi칩n a PostgreSQL exitosa. Hora actual:\", res.rows[0].now);\r\n        client.release();\r\n      })\r\n      .catch((err) => {\r\n        console.error(\"Error al ejecutar query de prueba:\", err);\r\n        client.release();\r\n      });\r\n  })\r\n  .catch((err) => {\r\n    console.error(\"No se pudo conectar a la base de datos:\", err);\r\n  });\r\n\r\nexport default db;\r\n"],"names":[],"mappings":";;;AAAA;AAGA;;;;;;AAFA,uIAAA,CAAA,UAAM,CAAC,MAAM;;AAIb,QAAQ,GAAG,CAAC;AACZ,QAAQ,GAAG,CAAC,iBAAiB,QAAQ,GAAG,CAAC,YAAY,IAAI;AAEzD,MAAM,KAAK,IAAI,oGAAA,CAAA,OAAI,CAAC;IAClB,kBAAkB,QAAQ,GAAG,CAAC,YAAY;IAC1C,KAAK;QACH,oBAAoB;IACtB;AACF;AAEA,6BAA6B;AAC7B,GAAG,OAAO,GACP,IAAI,CAAC,CAAC;IACL,OAAO,OACJ,KAAK,CAAC,gBACN,IAAI,CAAC,CAAC;QACL,QAAQ,GAAG,CAAC,+CAA+C,IAAI,IAAI,CAAC,EAAE,CAAC,GAAG;QAC1E,OAAO,OAAO;IAChB,GACC,KAAK,CAAC,CAAC;QACN,QAAQ,KAAK,CAAC,sCAAsC;QACpD,OAAO,OAAO;IAChB;AACJ,GACC,KAAK,CAAC,CAAC;IACN,QAAQ,KAAK,CAAC,2CAA2C;AAC3D;uCAEa","debugId":null}},
    {"offset": {"line": 144, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/omars/Documents/OMAR/prototipo/fonocom/src/app/api/usuario/actualizar/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server'\r\nimport db from '../../../../../db'\r\n\r\nexport async function POST(req: Request) {\r\n  try {\r\n    console.log('游릭 Entr칩 a POST /api/usuario/actualizar');\r\n    const body = await req.json()\r\n    const { username, password, id } = body\r\n\r\n    if (!username || !password) {\r\n      return NextResponse.json({ error: 'Faltan datos' }, { status: 400 })\r\n    }\r\n\r\n    // Actualiza el password del usuario y devuelve sus datos\r\n    const result = await db.query(\r\n      `UPDATE usuarios SET password = $1, username = $2 where id = $3 RETURNING id, username`,\r\n      [password, username, id]\r\n    )\r\n\r\n    if (result.rowCount === 0) {\r\n      return NextResponse.json({ error: 'Usuario no encontrado' }, { status: 404 })\r\n    }\r\n\r\n    const user = result.rows[0]\r\n\r\n    const progresoRes = await db.query(\r\n      `SELECT progreso_json FROM progreso WHERE usuarioid = $1`,\r\n      [user.id]\r\n    )\r\n\r\n    const progreso = progresoRes.rows[0]?.progreso_json || {\r\n      comunicacion: {},\r\n      empleo: {},\r\n      ideas: {},\r\n    }\r\n\r\n    return NextResponse.json({\r\n      user: {\r\n        username: user.username,\r\n        password: '',\r\n        progreso,\r\n      },\r\n    })\r\n  } catch (err) {\r\n    console.error('Error al actualizar usuario:', err)\r\n    return NextResponse.json({ error: 'Error interno del servidor' }, { status: 500 })\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;AAAA;AACA;;;;;;;AAEO,eAAe,KAAK,GAAY;IACrC,IAAI;QACF,QAAQ,GAAG,CAAC;QACZ,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,EAAE,EAAE,GAAG;QAEnC,IAAI,CAAC,YAAY,CAAC,UAAU;YAC1B,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAe,GAAG;gBAAE,QAAQ;YAAI;QACpE;QAEA,yDAAyD;QACzD,MAAM,SAAS,MAAM,oGAAA,CAAA,UAAE,CAAC,KAAK,CAC3B,CAAC,qFAAqF,CAAC,EACvF;YAAC;YAAU;YAAU;SAAG;QAG1B,IAAI,OAAO,QAAQ,KAAK,GAAG;YACzB,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAwB,GAAG;gBAAE,QAAQ;YAAI;QAC7E;QAEA,MAAM,OAAO,OAAO,IAAI,CAAC,EAAE;QAE3B,MAAM,cAAc,MAAM,oGAAA,CAAA,UAAE,CAAC,KAAK,CAChC,CAAC,uDAAuD,CAAC,EACzD;YAAC,KAAK,EAAE;SAAC;QAGX,MAAM,WAAW,YAAY,IAAI,CAAC,EAAE,EAAE,iBAAiB;YACrD,cAAc,CAAC;YACf,QAAQ,CAAC;YACT,OAAO,CAAC;QACV;QAEA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YACvB,MAAM;gBACJ,UAAU,KAAK,QAAQ;gBACvB,UAAU;gBACV;YACF;QACF;IACF,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,gCAAgC;QAC9C,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA6B,GAAG;YAAE,QAAQ;QAAI;IAClF;AACF","debugId":null}}]
}